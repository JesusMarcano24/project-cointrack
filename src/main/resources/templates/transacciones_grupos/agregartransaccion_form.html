<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" data-theme="light">
<head>
    <meta charset="UTF-8">
    <title>Transacción Grupal</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.22/dist/full.min.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        function setDateToday() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fecha').value = today;
        }
        function setDateYesterday() {
            const date = new Date();
            date.setDate(date.getDate() - 1);
            document.getElementById('fecha').value = date.toISOString().split('T')[0];
        }
        function setDateDayBeforeYesterday() {
            const date = new Date();
            date.setDate(date.getDate() - 2);
            document.getElementById('fecha').value = date.toISOString().split('T')[0];
        }
    </script>
</head>
<body>

<!-- Header común -->
<div th:replace="~{layout/base :: header}"></div>

<!-- Formulario -->
<form th:action="@{'/grupos/' + ${grupoId} + '/transacciones-grupales/new'}"
      th:object="${transaccion}"
      method="post"
      class="flex flex-col gap-4 p-5 w-full max-w-lg mx-auto bg-white rounded-xl shadow mt-8">

    <h2 class="text-center text-2xl font-bold">Nueva Transacción Grupal</h2>

    <!-- Tipo y Fecha -->
    <div class="flex gap-4">
        <div class="form-control w-1/2">
            <label class="label"><span class="label-text">Tipo:</span></label>
            <select th:field="*{tipo}" class="select select-bordered w-full">
                <option value="GASTO">Gasto</option>
                <option value="INGRESO">Ingreso</option>
            </select>
        </div>
        <div class="form-control w-1/2">
            <label class="label"><span class="label-text">Fecha:</span></label>
            <input type="date" th:field="*{fecha}" id="fecha" required class="input input-bordered w-full" />
        </div>
    </div>

    <!-- Botones rápidos de fecha -->
    <div class="flex gap-2">
        <button type="button" class="btn btn-sm" onclick="setDateToday()">Hoy</button>
        <button type="button" class="btn btn-sm" onclick="setDateYesterday()">Ayer</button>
        <button type="button" class="btn btn-sm" onclick="setDateDayBeforeYesterday()">Anteayer</button>
    </div>

    <!-- Monto -->
    <div class="form-control">
        <label class="label"><span class="label-text">Monto:</span></label>
        <input type="number" step="0.01" th:field="*{monto}" required class="input input-bordered w-full" placeholder="Ingrese el monto" />
    </div>

    <!-- Descripción -->
    <div class="form-control">
        <label class="label"><span class="label-text">Descripción:</span></label>
        <textarea th:field="*{descripcion}" class="textarea textarea-bordered" placeholder="Ingrese una descripción"></textarea>
    </div>

    <!-- Categoría -->
    <div class="form-control">
        <label class="label"><span class="label-text">Categoría:</span></label>
        <select th:field="*{categoria.id}" class="select select-bordered w-full">
            <option th:each="cat : ${categorias}" th:value="${cat.id}" th:text="${cat.nombre}">Categoría</option>
        </select>
    </div>

    <!-- Mensaje de error -->
    <div th:if="${error}" class="alert alert-error mt-2">
        <p th:text="${error}"></p>
    </div>

    <!-- Botones -->
    <div class="flex justify-between items-center mt-4">
        <a th:href="@{'/grupos/ver/' + ${grupoId}}" class="btn btn-neutral">Cancelar</a>
        <button type="submit" class="btn btn-primary">Guardar</button>
    </div>

</form>
</body>
</html>